# LinuC Level 1 学習ログ | 2025年8月17日

## 🎯 本日の学習サマリー

今日は試験前の総仕上げとして、**サーバーセキュリティと管理**に関連する広範なテーマの問題演習（2周目）に集中した。SSHやGPGによるセキュアな通信、`firewalld`や`xinetd`によるサービス管理とアクセス制御、`chage`や`visudo`による権限・ポリシー管理、そして`lsof`や`find`を使ったシステム監査まで、サーバーを堅牢に保つための知識を横断的に復習し、理解を深めた。

* **セキュアな通信と暗号化**: SSH（公開鍵認証, `sshd_config`, ポートフォワーディング）, GnuPG（鍵管理, 暗号化, 署名）
* **サービス管理とファイアウォール**: `firewalld`（ゾーン, サービス追加）, `xinetd`（スーパーサーバー）, レガシーなサービス管理
* **ユーザー監査と権限管理**: ログイン履歴 (`w`, `who`, `last`), 権限昇格 (`su`, `sudo`), パスワードポリシー (`chage`)
* **システム監査とリソース**: 特殊権限ファイルの検索 (`find`), プロセス監視 (`lsof`, `fuser`), リソース制限 (`ulimit`)

---

## 🤔 テーマ別：学びと考察

### 1. SSHとGPGによる多層的なセキュリティ（2周目）

* **新たな学び:**
    -   SSH関連のファイル群の役割分担が、復習を通じて完全に明確になった。サーバー側の設定は`/etc/ssh/sshd_config`（例: `PermitRootLogin no`）、クライアントを認証するための公開鍵はサーバーの`~/.ssh/authorized_keys`に置く、という流れを体系的に理解できた。「秘密鍵は絶対に渡してはならない」という原則が、問題のシナリオを通してより強く印象に残った。
    -   GnuPGの役割が、通信経路を暗号化するSSHとは異なり、ファイルやデータ**そのもの**を暗号化・署名するためのツールであることがはっきりと区別できた。相手の公開鍵で暗号化し、自分の秘密鍵で復号するという公開鍵暗号方式の基本フローを再確認した。
    -   SSHのポートフォワーディング（`-L`）や`ssh-agent`といった機能が、単なるリモートログインを超えた、柔軟なセキュア通信を実現するためのツールキットであることが分かった。

* **【気づき・思ったこと】**
    2周目を通して、SSHとGPGはサーバーセキュリティにおける「二重の鍵」のような存在だと感じた。SSHは「安全な通路」を確保し、GPGはその通路を通る「手紙」そのものを暗号化する。問題演習を重ねることで、それぞれのコマンドオプション（`ssh -p`, `gpg -e`など）が、具体的な目的を達成するための手段としてスムーズに頭に浮かぶようになってきた。セキュリティは一つの技術で完結するのではなく、複数の技術を適切に組み合わせる「多層防御」の考え方が基本なのだと実感した。

### 2. システムの防御・監査・管理（2周目）

* **新たな学び:**
    -   `firewalld`のゾーンという概念は、接続元のネットワークに応じてセキュリティレベルを変えるための強力な仕組みであると再認識した。また、設定変更には一時的なもの（ランタイム）と永続的なもの（`--permanent`）があるという区別が重要。
    -   `chage`コマンドは、単にパスワードの有効期限を決めるだけでなく、`-M`（最大有効日数）、`-W`（警告日数）、`-E`（アカウント有効期限）といったオプションを駆使して、組織のセキュリティポリシーを具体的にシステムへ反映させるためのツールだと理解した。
    -   `w`, `who`, `last`, `lsof`, `fuser`といったコマンド群は、サーバー管理者が「誰が、いつ、何をしているか」を把握するための強力な監査ツールである。特に`lsof -i :[ポート番号]`や`fuser [ファイル名]`は、原因不明のプロセスを特定する際の探偵のような役割を果たす。
    -   `find`コマンドで`-perm -4000`（SUID）のような特殊権限を持つファイルを探し出すことは、予期せぬ権限昇格の脆弱性を見つけ出すための、定期的なセキュリティ監査に不可欠な作業である。

* **【気づき・思ったこと】**
    1周目では個別のコマンドとして覚えていた知識が、2周目では「**防御**（`firewalld`）」「**方針**（`chage`, `visudo`）」「**監査**（`last`, `lsof`, `find`）」という、管理者としての具体的なアクションに結びついてきた。特に、`su`と`sudo`の違いや、`/etc/nologin`ファイルを使った一時的なログイン禁止措置など、様々な状況に応じて適切な手段を選択する判断力が問われるのだと感じた。これらの知識を組み合わせることで、初めてサーバーを安全に「管理」できるのだと、より深く理解できた。
    