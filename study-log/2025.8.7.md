# LinuC Level 1 学習ログ | 2025年8月7日

## 🎯 本日の学習サマリー

今日は、昨日に引き続きジョブのスケジューリングをテーマに、より深い階層である**システム全体のタスク管理**と**セキュリティ**に焦点を当てて学習した。個人の`crontab`だけでなく、システムワイドな`/etc/crontab`の役割や、`/etc/cron.daily`といったディレクトリを使ったジョブ管理方法を学んだ。また、`at`や`cron`の利用をユーザーごとに制御する`.allow`/`.deny`ファイルの仕組みや、24時間稼働しないサーバーのための`anacron`についてもハンズオンを通じて理解を深めた。

* `at`と`cron`のアクセス制御 (`/etc/at.allow`, `/etc/at.deny`など)
* システム全体の`crontab` (`/etc/crontab`) とユーザー`crontab`の違い
* ディレクトリベースのジョブ管理 (`/etc/cron.daily`, `/etc/cron.weekly`)
* `anacron`の役割と設定ファイル (`/etc/anacrontab`)

---

## 🤔 テーマ別：学びと考察

### 1. ジョブスケジューリングのアクセス制御

* **以前の理解:**
    `at`や`cron`は誰でも使えるものだと思っていた。ユーザーごとに利用可否を設定できるとは知らなかった。

* **新たな学び:**
    -   **`.allow`が最優先**: `/etc/cron.allow`や`/etc/at.allow`ファイルが存在する場合、そこに記載されたユーザーのみが利用を**許可**される（ホワイトリスト）。この時、`.deny`ファイルは無視される。
    -   **`.deny`は次点**: `.allow`ファイルがなく、`.deny`ファイルが存在する場合、そこに記載されたユーザーが利用を**拒否**される（ブラックリスト）。
    -   **デフォルトの挙動**: どちらのファイルも存在しない場合の挙動はシステムによるが、セキュリティ上、利用できるユーザーが制限されることがある。

* **【気づき・思ったこと】**
    複数人が利用するサーバーにおいて、誰にタスクの自動実行を許可するかを制御するのは、非常に重要なセキュリティ管理だと感じた。特に、許可したいユーザーだけを明記する`.allow`ファイルのホワイトリスト方式は、意図しないユーザーの利用を防ぐ上で、より安全で確実な方法だと思った。

### 2. システム全体のジョブ管理と`anacron`

* **以前の理解:**
    定期実行タスクは、すべて`crontab -e`で設定するものだと思っていた。

* **新たな学び:**
    -   `/etc/crontab`: システム全体で実行するタスクを記述するファイル。個人の`crontab`と違い、**実行ユーザーを指定する6番目のフィールド**がある。
    -   `/etc/cron.daily`など: 実行権限を付けたスクリプトをこのディレクトリに置くだけで、毎日・毎週・毎月、自動で実行してくれる。パッケージのアップデートチェックなど、多くのシステムメンテナンスがこの仕組みで動いている。
    -   `anacron`: サーバーが24時間稼働していない場合でも、「前回の実行から指定日数が経過していたら、次回の起動時に実行する」という賢い仕組み。ノートPCなどでcronジョブの実行漏れを防ぐためにある。

---

## 🚀 次のアクション

* テストユーザーを作成し、`/etc/cron.deny`と`/etc/at.deny`に追加して、実際に`crontab -e`や`at`コマンドが拒否されることを確認する。
* `/etc/cron.hourly`ディレクトリに、現在時刻をファイルに追記する簡単な自作スクリプトを設置し、1時間後にファイルが作成・更新されているか確認する。
* `/var/spool/anacron/`の中にあるタイムスタンプファイルの中身を見て、`cron.daily`な
どのジョブが最後にいつ実行されたのかを確認してみる。
